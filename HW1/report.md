# 数值代数第 1 次上机报告

> 陈润璘 2200010848

## 问题描述

求一个线性方程组的数值解是一个常见的问题。在本次作业中，我们使用 Gauss 消元法来求解线性方程组的数值解，同时使用平方根法和改进的平方根法来求解一个对称正定矩阵的线性方程组的数值解。

在第一个问题中，我们同时实现了不选主元的 Gauss 消元法、全主元的 Gauss 消元法和列主元的 Gauss 消元法，并且比较了这三种方法的误差。

## 数值方法

### 不选主元的 Gauss 消元法

不选主元的 Gauss 消元法是最简单的 Gauss 消元法。我们首先将线性方程组的系数矩阵分解为一个上三角矩阵和一个下三角矩阵的乘积，然后通过前代法和回代法求解线性方程组的数值解。

### 选主元的 Gauss 消元法

选主元的 Gauss 消元法是为了避免不选主元的 Gauss 消元法可能会导致的较大误差。在选主元的 Gauss 消元法中，我们首先选取一个主元,它可以是这一列中的最大元或ng剩余所有元中的最大元，然后将线性方程组的系数矩阵分解为一个上三角矩阵和一个下三角矩阵的乘积，然后通过前代法和回代法求解线性方程组的数值解。

通过选取主元，我们可以避免让一个较小的数除以一个较大的数，从而避免较大的误差。

## 具体算法实现

设我们要求解的线性方程组为 $Ax=b$，其中 $A$ 是一个 $n\times n$ 的矩阵，$b$ 是一个 $n\times 1$ 的向量。第 $i$ 步的消元过程如下：
设 $A^{(i)}$ 是第 $i$ 步的矩阵，$a_{ij}^{(i)}$ 是第 $i$ 步时第 $i$ 行第 $j$ 列的元素，如果 $a_{ij}^{(i)} \neq 0$ 我们可以进行初等行变换，使得 $a_{ij}^{(i)} = 0, \forall j > i$，这样我们就可以得到一个上三角矩阵。

如果我们使用选主元的 Gauss 消元法，我们需要在每一步中选取一个主元，使得 $|a_{ij}^{(i)}| = \max_{i\leq k \leq n} |a_{kj}^{(i)}|$ 或者 $|a_{ij}^{(i)}| = \max_{i\leq k \leq n, i\leq l \leq n} |a_{kl}^{(i)}|$，再交换行列。

我们使用 python 实现了这三种算法，具体实现见 `homework.py` 中的 `gauss_transform`，`gauss_transform_with_pivot` 和 `gauss_transform_with_full_pivot` 函数。

## 数值结果

使用我实现的 3 种算法分别计算一个特定的线性方程组的数值解，计算它与精确解之差的 2-范数和无穷范数。结果如下：

|Dimension | Normal(2 norm) | Normal(inf norm) | All Max(2 norm) | All Max(inf norm) | Column Max(2 norm) | Column Max(inf norm)|
|:--------:|:--------------:|:----------------:|:---------------:|:-----------------:|:------------------:|:-------------------:|
|    2     |    0.000000    |     0.000000     |    0.000000     |     0.000000      |      0.000000      |      0.000000       |
|    12    |    0.000000    |     0.000000     |    0.000000     |     0.000000      |      0.000000      |      0.000000       |
|    24    |    0.000000    |     0.000000     |    0.000000     |     0.000000      |      0.000000      |      0.000000       |
|    48    |    0.010564    |     0.007812     |    0.000000     |     0.000000      |      0.000000      |      0.000000       |
|    84    |725937666.403453| 536838143.999998 |    0.000004     |     0.000003      |      0.000004      |      0.000003       |

由此可见，选主元的 Gauss 消元法的误差要小于不选主元的 Gauss 消元法，全主元的 Gauss 消元法的误差与列主元的 Gauss 消元法的误差相当，因此大多数情况下我们可以使用列主元的 Gauss 消元法来求解线性方程组。
