# 数值代数第 2 次上机作业报告

> 陈润璘 2200010848

## 问题描述

在使用计算机求解一个线性方程组时，由于计算机的精度限制和实际问题中的扰动，求得的解与精确解之间可能存在误差，有时误差已经严重影响到了计算结果的可靠性。因此，我们需要对误差进行估计，以便评价计算结果的可靠性。

## 数值方法

为了估计线性方程组 $Ax=b$ 的解 $\hat{x}$ 的相对误差，我们可以采用如下的估计：

设 $r = b - A\hat{x} = A(x-\hat{x})$ 则 $\|x-\hat{x}\| = \|A^{-1}r\| \le \|A^{-1}\|\|r\|$。由 $\|b\|\le \|A\|\|x\|$, 从而有：
$$
\frac{\|x-\hat{x}\|}{\|x\|} \le \|A\|\|A^{-1}\|\frac{\|r\|}{\|b\|}
$$

为此，我们需要计算矩阵 $A$ 的条件数。

由于直接计算 $\kappa(A)$ 需要计算 $A$ 的逆，因此我们可以采用“盲人爬山法”对其进行估计，这一算法在已知 $A$ 的 LU 分解时仅需 $O(n^2)$ 的计算量。

在本次作业中，我们首先估计 Hilbert 矩阵的条件数，由此可以看出以 Hilbert 矩阵为系数矩阵的线性方程组的数值解的可靠性。然后，我们估计方程 $A_n x = b$ 的解的相对误差，其中

$$
A_n = \begin{pmatrix}
1 & 0 & 0 & \cdots & 1 \\
-1 & 1 & 0 & \cdots & 1 \\
-1 & -1 & 1 & \cdots & 1 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
-1 & -1 & -1 & \cdots & 1
\end{pmatrix}
$$

## 算法实现

由于在求解线性方程组时，我们需要计算矩阵的 LU 分解，因此我们可以直接使用这一分解结果计算条件数。

在计算 $A^{-T}$ 的 1-范数时，需要计算 $w=A^{-T}x$ 和 $z=A^{-1}v$，我们可以通过求解 $A^Tw=x$ 和 $Az=v$ 来计算，这只需要 $O(n^2)$ 的计算量。

## 数值结果

对于 5-20 阶 Hilbert 矩阵，估计的条件数结果如下：

| n  |  Condition Number  |
|:--:|:------------------:|
| 5  |     9.437e+05      |
| 6  |     2.907e+07      |
| 7  |     9.852e+08      |
| 8  |     3.387e+10      |
| 9  |     1.100e+12      |
| 10 |     3.421e+13      |
| 11 |     1.235e+15      |
| 12 |     4.255e+16      |
| 13 |     7.782e+17      |
| 14 |     1.149e+18      |
| 15 |     1.042e+18      |
| 16 |     1.008e+19      |
| 17 |     2.645e+18      |
| 18 |     7.590e+18      |
| 19 |     1.694e+19      |
| 20 |     1.972e+19      |

可以看出，Hilbert 矩阵的条件数随着阶数的增加而迅速增大，这意味着 Hilbert 矩阵的数值解的可靠性随着阶数的增加而迅速下降。

对于方程 $A_n x = b$，我们估计其解的相对误差如下：

|  n  |  Error Estimate  |
|:---:|:----------------:|
|  5  |    1.600e-15     |
|  6  |    1.672e-15     |
|  7  |    6.476e-15     |
|  8  |    2.185e-14     |
|  9  |    4.932e-14     |
| 10  |    5.840e-14     |
| 11  |    1.739e-13     |
| 12  |    1.001e-13     |
| 13  |    1.042e-13     |
| 14  |    5.732e-13     |
| 15  |    7.949e-13     |
| 16  |    1.612e-12     |
| 17  |    4.742e-12     |
| 18  |    4.145e-12     |
| 19  |    1.034e-11     |
| 20  |    5.998e-12     |
| 21  |    2.527e-11     |
| 22  |    2.189e-11     |
| 23  |    5.294e-11     |
| 24  |    2.791e-10     |
| 25  |    4.681e-10     |
| 26  |    3.359e-10     |
| 27  |    1.050e-09     |
| 28  |    5.515e-10     |
| 29  |    2.870e-09     |
| 30  |    2.117e-09     |

可以看出，这个方程的数值稳定性较好，其解的精确度可以满足大多数实际问题的需要。
