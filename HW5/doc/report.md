# 数值代数第 5 次上机作业报告

> 陈润璘 2200010848

## 问题描述

### 问题背景

在求偏微分方程的数值解时，一个常用的方法是差分法。在使用差分法的过程中，经常需要求解未知数很多的线性方程组。
在这种情况下，我们需要根据方程组的结构对求解过程进行优化，以提高求解效率。

### 问题描述

在本次上机作业中，我们使用条带平方根法、Gauss-Seidel迭代法、共轭梯度法和多重网格方法来求解一个在求解偏微分方程时遇到的大规模线性方程组，
并优化算法已实现更高的求解效率和更少的内存占用。

## 数值方法

### 平方根法

由于我们求解的矩阵是一个正定矩阵，我们可以使用平方根法求解。在平方根法中，我们首先将系数矩阵分解为 $LDL^T$ 的形式，其中 $L$ 是一个下三角矩阵。然后我们可以通过求解两个三角方程组来求解原方程组。

### Gauss-Seidel 迭代法

Gauss-Seidel 迭代法在每一步对残量方程近似求解，并更新解向量。在近似求解的过程中，我们使用前面以求解的分量来近似求解后面的分量。

### 共轭梯度法

共轭梯度法是一种迭代法，它从最速下降法改进而来，在每一步中，我们选择一个共轭方向，并在这个方向上求解一个一维的最优化问题。

### 多重网格方法

多重网格方法利用了 Gauss-Seidel 迭代法的磨光性，在进行几步 Gauss-Seidel 迭代后，我们将残量限制在一个粗网格上，并在粗网格上求解残量方程。然后我们将残量提升回细网格，并在细网格上再进行几步 Gauss-Seidel 迭代。

## 算法实现

由于本次上机作业中涉及的矩阵规模较大，我使用了 C++ 实现上述四种算法。在实现算法的过程中，我使用了 `Eigen` 库来存储稀疏矩阵。更多的实现细节可以参考我的代码和 `code/README.md`。

## 数值结果

在本次上机作业中，我使用了一个 $N^2 \times N^2$ 的矩阵，其中 $N = 64, 128, 256, 512, 1024$。我分别使用了条带平方根法、Gauss-Seidel 迭代法、共轭梯度法和多重网格方法来求解这个矩阵，并记录了求解的误差和时间。

LDL 分解的结果如下：
|  N   | 误差       | 时间       |
|:----:|:---------:|:----------:|
|  64  | 0.0001004 | 3.42983ms  |
| 128  | 0.0000251 | 42.2563ms  |
| 256  | 0.0000063 | 571.468ms  |
| 512  | 0.0000016 | 8223.14ms  |
| 1024 | 0.0000004 | 117841ms   |

Gauss-Seidel 迭代法的结果如下：

|  N   | 误差       | 时间       | 迭代次数   |
|:----:|:---------:|:----------:|:----------:|
|  64  | 0.0000999 | 205.918ms  | 5733       |
| 128  | 0.0000246 | 3321.94ms  | 22934      |
| 256  | 0.0000058 | 53968.9ms  | 91737      |
| 512  |   -    |   -   |    -     |
| 1024 |   -   |   -   |    -    |

其中，当 $N = 512, 1024$ 时，Gauss-Seidel 迭代法运行时间过长，无法得到结果。

共轭梯度法的结果如下：

|  N   | 误差       | 时间       | 迭代次数   |
|:----:|:---------:|:----------:|:----------:|
|  64  | 0.0001004 | 0.35435ms  | 1         |
| 128  | 0.0000251 | 1.41514ms  | 1         |
| 256  | 0.0000063 | 5.30027ms  | 1         |
| 512  | 0.0000016 | 23.7038ms  | 1         |
| 1024 | 0.0000004 | 74.1613ms  | 1         |

多重网格方法的结果如下：

|  N   | 误差       | 时间       | 迭代次数   |
|:----:|:---------:|:----------:|:----------:|
|  64  | 0.0001004 | 2.21251ms  | 4         |
| 128  | 0.0000251 | 8.85926ms  | 4         |
| 256  | 0.0000063 | 43.2501ms  | 4         |
| 512  | 0.0000016 | 162.453ms  | 4         |
| 1024 | 0.0000004 | 583.066ms  | 4         |

从上述结果可以看出，对于大规模的线性方程组的求解，精心设计的迭代法的效率往往高于直接法。在本次上机作业中，共轭梯度法和多重网格方法的效率明显高于条带平方根法。

对比多重网格方法和 Gauss-Seidel 迭代法，我们可以看到多重网格方法的效率更高，这是因为多重网格方法利用了 Gauss-Seidel 迭代法的磨光性，同时在粗网格上求解残量方程，从而减少了迭代次数。